<h3 class="mt-3">Ability Scores</h3>
<div class="container">
  <div class="row">

    <!-- NEW CHARACTER -->
    <div class="col-8 p-0" *ngIf="charIsNew==true">

      <div class="d-flex flex-nowrap row mt-1" *ngFor="let abbr of bindedAbbreviationKeys">

        <div class="d-flex align-items-start flex-column ml-3" style="width: 3.5em; flex: 0 0 auto;">
          <h4 class="pt-1 pb-0 mb-0">{{ abbr }}</h4>
          <small class="text-black-50 xx-small">{{ abilityScoreAbbr.abbreviation.get(abbr) }}</small>
        </div>

        <div [ngSwitch]="abbr" class="d-flex align-items-center flex-column ml-1">
          <div>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'STR'" [value]="totalAbilityScores.strength" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'DEX'" [value]="totalAbilityScores.dexterity" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CON'" [value]="totalAbilityScores.constitution" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input [ngClass]="totalAbilityScores.intelligence !== 0 && totalAbilityScores.intelligence <= 9 ? 'is-invalid' : ''" class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'INT'" [value]="totalAbilityScores.intelligence" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input [ngClass]="totalAbilityScores.wisdom !== 0 && totalAbilityScores.wisdom <= 9 ? 'is-invalid' : ''" class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'WIS'" [value]="totalAbilityScores.wisdom" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input [ngClass]="totalAbilityScores.charisma !== 0 && totalAbilityScores.charisma <= 9 ? 'is-invalid' : ''" class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CHA'" [value]="totalAbilityScores.charisma" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchDefault [value]="">
          </div>
          <div class="xx-small" *ngSwitchCase="'INT'"><small *ngIf="totalAbilityScores.intelligence !== 0 && totalAbilityScores.intelligence <= 9" class="text-danger xx-small">{{ abilityScoreAbbr.abbreviation.get(abbr) }} is too low to cast spells tied to this ability</small></div>
          <div class="xx-small" *ngSwitchCase="'WIS'"><small *ngIf="totalAbilityScores.wisdom !== 0 && totalAbilityScores.wisdom <= 9" class="text-danger xx-small">{{ abilityScoreAbbr.abbreviation.get(abbr) }} is too low to cast spells tied to this ability</small></div>
          <div class="xx-small" *ngSwitchCase="'CHA'"><small *ngIf="totalAbilityScores.charisma !== 0 && totalAbilityScores.charisma <= 9" class="text-danger xx-small">{{ abilityScoreAbbr.abbreviation.get(abbr) }} is too low to cast spells tied to this ability</small></div>
          <small *ngSwitchDefault class="text-black-50 xx-small">Total</small>
        </div>

        <div class="d-flex align-items-center flex-column ml-1" style="margin-top: 0.35em; width: 2.5em; flex: 0 0 auto;">
          <div [ngSwitch]="abbr">
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'STR'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.strength) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'DEX'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.dexterity) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'CON'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.constitution) }}</span>
            <span [ngClass]="totalAbilityScores.intelligence !== 0 && totalAbilityScores.intelligence <= 9 ? 'badge-danger' : ''" class="badge badge-pill badge-secondary" *ngSwitchCase="'INT'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.intelligence) }}</span>
            <span [ngClass]="totalAbilityScores.wisdom !== 0 && totalAbilityScores.wisdom <= 9 ? 'badge-danger' : ''" class="badge badge-pill badge-secondary" *ngSwitchCase="'WIS'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.wisdom) }}</span>
            <span [ngClass]="totalAbilityScores.charisma !== 0 && totalAbilityScores.charisma <= 9 ? 'badge-danger' : ''" class="badge badge-pill badge-secondary" *ngSwitchCase="'CHA'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.charisma) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchDefault title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier"></span>
          </div>
        </div>

        <div class="d-flex align-items-center flex-column ml-1 math-sign">
          <h6 class="pt-2 pb-2 mb-0">=</h6>
        </div>

        <div class="d-flex align-items-center flex-column ml-1">
          <div [ngSwitch]="abbr">
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'STR'" [value]="baseAbilityScores.strength" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'DEX'" [value]="baseAbilityScores.dexterity" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CON'" [value]="baseAbilityScores.constitution" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'INT'" [value]="baseAbilityScores.intelligence" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'WIS'" [value]="baseAbilityScores.wisdom" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CHA'" [value]="baseAbilityScores.charisma" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchDefault [value]="">
          </div>
          <small class="text-black-50 xx-small">Base Score</small>
        </div>

        <div class="d-flex align-items-center flex-column ml-1">
          <div [ngSwitch]="abbr" *ngIf="selectedRace !== undefined">
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'STR'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="123" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'DEX'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="123" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CON'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="123" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'INT'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="123" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'WIS'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="123" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CHA'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="123" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchDefault title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="0" readonly>
          </div>
          <div [ngSwitch]="abbr" *ngIf="selectedRace === undefined">
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchDefault title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Racial Bonuses" value="0" readonly>
          </div>
          <small class="text-black-50 xx-small">Racial</small>
        </div>

        <div class="d-flex mr-3">

          <div class="d-flex align-items-start flex-grow-1 ml-1">
            <input class="btn btn-outline-dark" style="width: 10em;" type="button" (click)="rollNewAbilityScore(abbr)" value="Roll {{ abilityScoreAbbr.abbreviation.get(abbr) }}" title="Rolls 4d6 (dropping the lowest die)">
          </div>

          <div class="d-flex align-items-start flex-shrink-0 ml-1">
            <input class="btn btn-outline-dark" style="width: 2.5em;" (click)="lowerAbilityScore(abbr)" value="-">
          </div>

          <div class="d-flex align-items-start flex-shrink-0 ml-1">
            <input class="btn btn-outline-dark" style="width: 2.5em;" (click)="raiseAbilityScore(abbr)" value="+">
          </div>

        </div>

      </div>

    </div>

    <div class="col-4 pr-0" *ngIf="charIsNew==true">

      <div class="jumbotron p-3 mb-1" style="text-align: center;">
        <h1 class="display-1">{{ pointBuy }}</h1>
        <p class="lead">Point Buy Total</p>
        <p *ngIf="pointBuy < 0" class="text-danger">Low-powered</p>
        <p *ngIf="pointBuy === 0" class="text-muted">&nbsp;</p>
        <p *ngIf="pointBuy >= 1 && pointBuy <= 15" class="text-danger">Low-powered</p>
        <p *ngIf="pointBuy >= 16 && pointBuy <= 22" class="text-warning">Challenging</p>
        <p *ngIf="pointBuy >= 23 && pointBuy <= 28" class="text-info">Normal</p>
        <p *ngIf="pointBuy >= 29 && pointBuy <= 32" class="text-warning">High-powered</p>
        <p *ngIf="pointBuy >= 33" class="text-danger">God Tier</p>
      </div>

      <div>
        <label for="typeahead-focus">Race:</label>
        <input
          id="typeahead-focus"
          type="text"
          class="form-control"
          placeholder="What race are you?"
          [(ngModel)]="typeAheadRace"
          [ngbTypeahead]="search"
          [resultTemplate]="rt"
          [resultFormatter]="formatMatches"
          [inputFormatter]="formatMatches"
          (focus)="focus$.next($event.target.value)"
          (click)="click$.next($event.target.value)"
          #instance="ngbTypeahead"
        />
        <hr>
        <pre>Model: {{ typeAheadRace | json }}</pre>
        <ng-template #rt let-r="result" let-t="term">
          {{ r.name }}
        </ng-template>
      </div>

    </div>


    <!-- EXISTING CHARACTER -->
    <div class="" *ngIf="charIsNew==false">

      <div class="d-flex flex-nowrap row mt-1" *ngFor="let abbr of bindedAbbreviationKeys">

        <div class="d-flex align-items-start flex-column ml-3" style="width: 3.5em; flex: 0 0 auto;">
          <h4 class="pt-1 pb-0 mb-0">{{ abbr }}</h4>
          <small class="text-black-50 xx-small">{{ abilityScoreAbbr.abbreviation.get(abbr) }}</small>
        </div>

        <div class="d-flex align-items-center flex-column ml-1">
          <div [ngSwitch]="abbr">
            <input class="form-control form-control pt-2 pb-2 mb-0" *ngSwitchCase="'STR'" [value]="totalAbilityScores.strength" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control form-control pt-2 pb-2 mb-0" *ngSwitchCase="'DEX'" [value]="totalAbilityScores.dexterity" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CON'" [value]="totalAbilityScores.constitution" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control form-control pt-2 pb-2 mb-0" *ngSwitchCase="'INT'" [value]="totalAbilityScores.intelligence" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control form-control pt-2 pb-2 mb-0" *ngSwitchCase="'WIS'" [value]="totalAbilityScores.wisdom" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CHA'" [value]="totalAbilityScores.charisma" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Total" readonly>
            <input class="form-control form-control pt-2 pb-2 mb-0" *ngSwitchDefault [value]="">
          </div>
          <small class="text-black-50 xx-small">Total</small>
        </div>

        <div class="d-flex align-items-center flex-column ml-1" style="margin-top: 0.35em; width: 2.5em; flex: 0 0 auto;">
          <div [ngSwitch]="abbr">
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'STR'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.strength) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'DEX'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.dexterity) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'CON'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.constitution) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'INT'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.intelligence) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'WIS'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.wisdom) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchCase="'CHA'" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier">{{ getAbilityModifier(totalAbilityScores.charisma) }}</span>
            <span class="badge badge-pill badge-secondary" *ngSwitchDefault title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Modifier"></span>
          </div>
        </div>

        <div class="d-flex align-items-center flex-column ml-1 math-sign">
          <h6 class="pt-2 pb-2 mb-0">=</h6>
        </div>

        <div class="d-flex align-items-center flex-column ml-1">
          <div [ngSwitch]="abbr">
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'STR'" [value]="baseAbilityScores.strength" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score + Racial Bonuses" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'DEX'" [value]="baseAbilityScores.dexterity" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score + Racial Bonuses" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CON'" [value]="baseAbilityScores.constitution" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score + Racial Bonuses" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'INT'" [value]="baseAbilityScores.intelligence" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score + Racial Bonuses" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'WIS'" [value]="baseAbilityScores.wisdom" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score + Racial Bonuses" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchCase="'CHA'" [value]="baseAbilityScores.charisma" title="{{ abilityScoreAbbr.abbreviation.get(abbr) }} Base Score + Racial Bonuses" readonly>
            <input class="form-control pt-2 pb-2 mb-0" *ngSwitchDefault [value]="">
          </div>
          <small class="text-black-50 xx-small">Base Score + Racial</small>
        </div>

        <div class="d-flex">

          <div class="d-flex align-items-center flex-column ml-1 math-sign">
            <h6 class="pt-2 pb-2 mb-0">+</h6>
          </div>

          <div class="d-flex align-items-center flex-column ml-1">
            <input class="form-control pt-2 pb-2 mb-0" title="Enhancement Bonuses">
            <small class="text-black-50 xx-small">Enhancement Bonuses</small>
          </div>

          <div class="d-flex align-items-center flex-column ml-1 math-sign">
            <h6 class="pt-2 pb-2 mb-0">+</h6>
          </div>

          <div class="d-flex align-items-center flex-column ml-1">
            <input class="form-control pt-2 pb-2 mb-0" title="Misc Bonuses">
            <small class="text-black-50 xx-small">Misc Bonuses</small>
          </div>

          <div class="d-flex align-items-center flex-column ml-1 math-sign">
            <h6 class="pt-2 pb-2 mb-0">-</h6>
          </div>

          <div class="d-flex align-items-center flex-column ml-1 mr-3">
            <input class="form-control pt-2 pb-2 mb-0" title="Misc Penalties">
            <small class="text-black-50 xx-small">Misc Penalties</small>
          </div>

        </div>

      </div>

    </div>

  </div>
</div>
<div class="d-flex flex-row-reverse mt-3" *ngIf="charIsNew==true">
  <a routerLink="/character/new/class" class="btn" [ngClass]="readyToPickClass ? 'btn-primary' : 'btn-dark disabled'">Next: Character Class <i class="fas fa-hat-wizard"></i></a>
</div>
